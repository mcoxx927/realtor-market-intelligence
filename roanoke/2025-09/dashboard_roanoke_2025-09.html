<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roanoke Metro Market Intelligence Dashboard - September 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .card {
            background: linear-gradient(135deg, #16213e 0%, #0f3460 100%);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }
        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .trend-up { color: #10b981; }
        .trend-down { color: #ef4444; }
        .trend-neutral { color: #f59e0b; }
        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
        }
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        .chart-container {
            position: relative;
            height: 300px;
        }
        .city-row {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .city-row:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        .health-bar {
            height: 8px;
            border-radius: 4px;
            display: inline-block;
            width: 60px;
        }
        .health-strong { background: linear-gradient(90deg, #10b981, #059669); }
        .health-moderate { background: linear-gradient(90deg, #f59e0b, #d97706); }
        .health-weak { background: linear-gradient(90deg, #ef4444, #dc2626); }
    </style>
</head>
<body class="min-h-screen p-6">
    <div class="max-w-7xl mx-auto space-y-6 animate-fade-in">

        <!-- Header -->
        <div class="card p-8 text-white">
            <h1 class="text-4xl font-bold mb-2">Roanoke Metro Market Intelligence</h1>
            <p class="text-xl text-gray-300">September 2025 Comprehensive Report</p>
            <div class="mt-4 flex flex-wrap gap-4 text-sm">
                <span class="px-3 py-1 bg-blue-500/20 rounded-full">17 Cities Analyzed</span>
                <span class="px-3 py-1 bg-green-500/20 rounded-full">243 Sales</span>
                <span class="px-3 py-1 bg-purple-500/20 rounded-full">Market BULLISH</span>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="card p-6 text-white">
            <h2 class="text-2xl font-bold mb-4">Market Overview</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="metric-card p-4 rounded-lg">
                    <div class="text-sm text-gray-400">Market Sentiment</div>
                    <div class="text-2xl font-bold text-green-400">BULLISH</div>
                    <div class="text-xs mt-2 text-gray-300">Ultra-fast absorption with explosive sales growth</div>
                </div>
                <div class="metric-card p-4 rounded-lg">
                    <div class="text-sm text-gray-400">Key Insight</div>
                    <div class="text-sm mt-2">Sales up 48.6% YoY with median DOM of 26 days (62% faster than Charlotte)</div>
                </div>
                <div class="metric-card p-4 rounded-lg">
                    <div class="text-sm text-gray-400">Market Health</div>
                    <div class="text-lg font-bold text-green-400">79/100 Average</div>
                    <div class="text-xs mt-2 text-gray-300">Strong fundamentals across metro</div>
                </div>
            </div>
        </div>

        <!-- Metro-Level Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Median Sale Price</div>
                <div class="text-3xl font-bold">$358K</div>
                <div class="text-sm mt-2 trend-up">↑ +4.1% YoY</div>
            </div>
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Homes Sold</div>
                <div class="text-3xl font-bold">243</div>
                <div class="text-sm mt-2 trend-up">↑ +48.6% YoY</div>
            </div>
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Days on Market</div>
                <div class="text-3xl font-bold">26</div>
                <div class="text-sm mt-2 text-green-400">Ultra-fast sales</div>
            </div>
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Months of Supply</div>
                <div class="text-3xl font-bold">2.5</div>
                <div class="text-sm mt-2 text-green-400">Strong seller market</div>
            </div>
        </div>

        <!-- Additional Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Median List Price</div>
                <div class="text-xl font-bold">$330K</div>
            </div>
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Price per SF</div>
                <div class="text-xl font-bold">$177</div>
            </div>
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Sale-to-List</div>
                <div class="text-xl font-bold">98.5%</div>
            </div>
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Active Inventory</div>
                <div class="text-xl font-bold">684</div>
            </div>
        </div>

        <!-- Search and Filters -->
        <div class="card p-6 text-white">
            <div class="flex flex-col md:flex-row gap-4 items-center justify-between mb-6">
                <h2 class="text-2xl font-bold">Top 10 Cities by Sales Volume</h2>
                <div class="flex gap-2">
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="Search cities..."
                        class="search-input"
                    />
                    <select id="filterSelect" class="search-input">
                        <option value="all">All Markets</option>
                        <option value="hot">Hot (Health ≥80)</option>
                        <option value="cooling">Cooling (Health <70)</option>
                    </select>
                </div>
            </div>

            <!-- Cities Table -->
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="border-b border-gray-600">
                        <tr class="text-left">
                            <th class="pb-3">City</th>
                            <th class="pb-3">Sales</th>
                            <th class="pb-3">Median Price</th>
                            <th class="pb-3">Price YoY</th>
                            <th class="pb-3">DOM</th>
                            <th class="pb-3">Health Score</th>
                        </tr>
                    </thead>
                    <tbody id="citiesTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Selected City Details -->
            <div id="cityDetails" class="mt-6 p-4 bg-white/5 rounded-lg hidden">
                <h3 class="text-lg font-bold mb-2" id="selectedCityName"></h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div>
                        <div class="text-gray-400">Sales Volume</div>
                        <div class="text-xl font-bold" id="detailSales"></div>
                    </div>
                    <div>
                        <div class="text-gray-400">Median Price</div>
                        <div class="text-xl font-bold" id="detailPrice"></div>
                    </div>
                    <div>
                        <div class="text-gray-400">Days on Market</div>
                        <div class="text-xl font-bold" id="detailDOM"></div>
                    </div>
                    <div>
                        <div class="text-gray-400">Market Status</div>
                        <div class="text-xl font-bold" id="detailStatus"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card p-6 text-white">
                <h2 class="text-2xl font-bold mb-4">Sales Volume by City</h2>
                <div class="chart-container">
                    <canvas id="salesChart"></canvas>
                </div>
            </div>

            <div class="card p-6 text-white">
                <h2 class="text-2xl font-bold mb-4">Median Price by City</h2>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card p-6 text-white">
            <h2 class="text-2xl font-bold mb-4">Market Health Score Distribution</h2>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                <div class="text-center">
                    <div class="text-3xl font-bold text-green-400" id="countStrong">0</div>
                    <div class="text-sm text-gray-400">Strong (80+)</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-yellow-400" id="countModerate">0</div>
                    <div class="text-sm text-gray-400">Moderate (70-79)</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-red-400" id="countWeak">0</div>
                    <div class="text-sm text-gray-400">Weak (<70)</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-blue-400" id="avgScore">0</div>
                    <div class="text-sm text-gray-400">Average Score</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-purple-400" id="maxScore">0</div>
                    <div class="text-sm text-gray-400">Highest Score</div>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="healthChart"></canvas>
            </div>
        </div>

        <!-- Market Insights -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card p-6 text-white">
                <h3 class="text-xl font-bold mb-4">Hot Markets (Health ≥80)</h3>
                <div id="hotMarkets" class="space-y-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>

            <div class="card p-6 text-white">
                <h3 class="text-xl font-bold mb-4">Affordable Options (<$300K)</h3>
                <div id="affordableMarkets" class="space-y-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Key Takeaways -->
        <div class="card p-6 text-white">
            <h2 class="text-2xl font-bold mb-4">Key Takeaways</h2>
            <div class="space-y-4">
                <div class="p-4 bg-green-500/10 border-l-4 border-green-500 rounded">
                    <div class="font-bold mb-2">Explosive Sales Growth</div>
                    <div class="text-sm text-gray-300">Metro-wide sales surged 48.6% YoY to 243 transactions, indicating strong demand recovery.</div>
                </div>
                <div class="p-4 bg-blue-500/10 border-l-4 border-blue-500 rounded">
                    <div class="font-bold mb-2">Ultra-Fast Absorption</div>
                    <div class="text-sm text-gray-300">Median DOM of 26 days is 62% faster than Charlotte, indicating strong buyer demand.</div>
                </div>
                <div class="p-4 bg-purple-500/10 border-l-4 border-purple-500 rounded">
                    <div class="font-bold mb-2">Seller's Market</div>
                    <div class="text-sm text-gray-300">2.5 months of supply indicates strong seller advantage with limited inventory.</div>
                </div>
                <div class="p-4 bg-yellow-500/10 border-l-4 border-yellow-500 rounded">
                    <div class="font-bold mb-2">Top Performers</div>
                    <div class="text-sm text-gray-300">Hollins, Salem, Blue Ridge, and Vinton lead with health scores above 80.</div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="card p-6 text-white text-center text-sm text-gray-400">
            <p>Dashboard generated on October 15, 2025 | Data period: September 2025</p>
            <p class="mt-2">Data source: Redfin Market Tracker | Analysis: 17 cities, 243 transactions</p>
            <p class="mt-2">Health scores calculated using sales velocity, days on market, pricing trends, and inventory balance</p>
        </div>
    </div>

    <script>
        // Market data - Top 10 cities by sales volume
        const allCities = [
            { name: 'Roanoke', sales: 101, price: 224000, priceYoY: -0.034, dom: 24, health: 75 },
            { name: 'Cave Spring', sales: 28, price: 367000, priceYoY: 0.034, dom: 18, health: 78 },
            { name: 'Salem', sales: 26, price: 290000, priceYoY: -0.079, dom: 21, health: 83 },
            { name: 'Hollins', sales: 22, price: 315000, priceYoY: 0.067, dom: 31, health: 93 },
            { name: 'North Shore', sales: 21, price: 625000, priceYoY: 0.214, dom: 39, health: 71 },
            { name: 'Rocky Mount', sales: 7, price: 218000, priceYoY: -0.031, dom: 7, health: 85 },
            { name: 'Vinton', sales: 6, price: 228750, priceYoY: -0.092, dom: 15, health: 81 },
            { name: 'Westlake Corner', sales: 6, price: 994950, priceYoY: 0.458, dom: 44, health: 71 },
            { name: 'Union Hall', sales: 5, price: 1534999, priceYoY: 0.687, dom: 88, health: 71 },
            { name: 'Cloverdale', sales: 5, price: 505000, priceYoY: 0.611, dom: 25, health: 79 }
        ];

        let currentFilter = 'all';
        let searchTerm = '';
        let selectedCity = null;

        // Utility functions
        const formatPrice = (value) => `$${(value / 1000).toFixed(0)}K`;
        const formatPercent = (value) => `${(value * 100).toFixed(1)}%`;
        const getTrendClass = (value) => value > 0 ? 'trend-up' : value < 0 ? 'trend-down' : 'trend-neutral';
        const getTrendIcon = (value) => value > 0 ? '↑' : value < 0 ? '↓' : '→';
        const getHealthClass = (score) => score >= 80 ? 'health-strong' : score >= 70 ? 'health-moderate' : 'health-weak';
        const getHealthText = (score) => score >= 80 ? 'Strong' : score >= 70 ? 'Moderate' : 'Weak';

        // Filter cities
        function getFilteredCities() {
            return allCities.filter(city => {
                const matchesSearch = city.name.toLowerCase().includes(searchTerm.toLowerCase());
                if (currentFilter === 'hot') return matchesSearch && city.health >= 80;
                if (currentFilter === 'cooling') return matchesSearch && city.health < 70;
                return matchesSearch;
            });
        }

        // Render cities table
        function renderCitiesTable() {
            const tbody = document.getElementById('citiesTableBody');
            const filtered = getFilteredCities();

            tbody.innerHTML = filtered.map(city => `
                <tr class="city-row border-b border-gray-700" onclick="selectCity('${city.name}')">
                    <td class="py-3 font-medium">${city.name}</td>
                    <td class="py-3">${city.sales}</td>
                    <td class="py-3">${formatPrice(city.price)}</td>
                    <td class="py-3 ${getTrendClass(city.priceYoY)}">
                        ${getTrendIcon(city.priceYoY)} ${formatPercent(city.priceYoY)}
                    </td>
                    <td class="py-3">${city.dom} days</td>
                    <td class="py-3">
                        <span class="health-bar ${getHealthClass(city.health)}"></span>
                        <span class="ml-2">${city.health}</span>
                    </td>
                </tr>
            `).join('');
        }

        // Select city
        function selectCity(cityName) {
            const city = allCities.find(c => c.name === cityName);
            if (!city) return;

            if (selectedCity === cityName) {
                selectedCity = null;
                document.getElementById('cityDetails').classList.add('hidden');
            } else {
                selectedCity = cityName;
                document.getElementById('selectedCityName').textContent = city.name + ' Details';
                document.getElementById('detailSales').textContent = city.sales;
                document.getElementById('detailPrice').textContent = formatPrice(city.price);
                document.getElementById('detailDOM').textContent = city.dom + ' days';
                document.getElementById('detailStatus').textContent = getHealthText(city.health);
                document.getElementById('cityDetails').classList.remove('hidden');
            }
        }

        // Render market lists
        function renderMarketLists() {
            const hotMarkets = allCities.filter(c => c.health >= 80);
            const affordableMarkets = allCities.filter(c => c.price < 300000);

            document.getElementById('hotMarkets').innerHTML = hotMarkets.map(city => `
                <div class="flex justify-between items-center p-3 bg-white/5 rounded">
                    <span class="font-medium">${city.name}</span>
                    <div class="flex items-center gap-2">
                        <span class="text-green-400">${formatPrice(city.price)}</span>
                        <span class="text-sm text-gray-400">${city.health}/100</span>
                    </div>
                </div>
            `).join('') || '<div class="text-gray-400">No markets with health score ≥80</div>';

            document.getElementById('affordableMarkets').innerHTML = affordableMarkets.map(city => `
                <div class="flex justify-between items-center p-3 bg-white/5 rounded">
                    <span class="font-medium">${city.name}</span>
                    <div class="flex items-center gap-2">
                        <span class="text-blue-400">${formatPrice(city.price)}</span>
                        <span class="text-sm text-gray-400">${city.dom} DOM</span>
                    </div>
                </div>
            `).join('') || '<div class="text-gray-400">No markets under $300K</div>';
        }

        // Update health stats
        function updateHealthStats() {
            const strong = allCities.filter(c => c.health >= 80).length;
            const moderate = allCities.filter(c => c.health >= 70 && c.health < 80).length;
            const weak = allCities.filter(c => c.health < 70).length;
            const avg = Math.round(allCities.reduce((sum, c) => sum + c.health, 0) / allCities.length);
            const max = Math.max(...allCities.map(c => c.health));

            document.getElementById('countStrong').textContent = strong;
            document.getElementById('countModerate').textContent = moderate;
            document.getElementById('countWeak').textContent = weak;
            document.getElementById('avgScore').textContent = avg;
            document.getElementById('maxScore').textContent = max;
        }

        // Chart setup
        Chart.defaults.color = '#9ca3af';
        Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.1)';

        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: 'rgba(15, 52, 96, 0.95)',
                    titleColor: '#fff',
                    bodyColor: '#e5e7eb',
                    borderColor: 'rgba(255, 255, 255, 0.2)',
                    borderWidth: 1
                }
            },
            scales: {
                y: {
                    grid: { color: 'rgba(255, 255, 255, 0.05)' },
                    ticks: { color: '#9ca3af' }
                },
                x: {
                    grid: { display: false },
                    ticks: { color: '#9ca3af', maxRotation: 45, minRotation: 45 }
                }
            }
        };

        // Sales Chart
        new Chart(document.getElementById('salesChart'), {
            type: 'bar',
            data: {
                labels: allCities.map(c => c.name),
                datasets: [{
                    label: 'Sales',
                    data: allCities.map(c => c.sales),
                    backgroundColor: '#3b82f6'
                }]
            },
            options: chartOptions
        });

        // Price Chart
        new Chart(document.getElementById('priceChart'), {
            type: 'bar',
            data: {
                labels: allCities.map(c => c.name),
                datasets: [{
                    label: 'Median Price',
                    data: allCities.map(c => c.price),
                    backgroundColor: '#10b981'
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            color: '#9ca3af',
                            callback: (value) => formatPrice(value)
                        }
                    }
                }
            }
        });

        // Health Chart
        new Chart(document.getElementById('healthChart'), {
            type: 'bar',
            data: {
                labels: allCities.map(c => c.name),
                datasets: [{
                    label: 'Health Score',
                    data: allCities.map(c => c.health),
                    backgroundColor: allCities.map(c =>
                        c.health >= 80 ? '#10b981' : c.health >= 70 ? '#f59e0b' : '#ef4444'
                    )
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        min: 0,
                        max: 100
                    }
                }
            }
        });

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchTerm = e.target.value;
            renderCitiesTable();
        });

        document.getElementById('filterSelect').addEventListener('change', (e) => {
            currentFilter = e.target.value;
            renderCitiesTable();
        });

        // Initial render
        renderCitiesTable();
        renderMarketLists();
        updateHealthStats();
    </script>
</body>
</html>
