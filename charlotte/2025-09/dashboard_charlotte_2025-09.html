<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charlotte Metro Market Intelligence Dashboard - September 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .card {
            background: linear-gradient(135deg, #16213e 0%, #0f3460 100%);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }
        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .trend-up { color: #10b981; }
        .trend-down { color: #ef4444; }
        .trend-neutral { color: #f59e0b; }
        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
        }
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        .chart-container {
            position: relative;
            height: 300px;
        }
        .city-row {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .city-row:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        .health-bar {
            height: 8px;
            border-radius: 4px;
            display: inline-block;
            width: 60px;
        }
        .health-strong { background: linear-gradient(90deg, #10b981, #059669); }
        .health-moderate { background: linear-gradient(90deg, #f59e0b, #d97706); }
        .health-weak { background: linear-gradient(90deg, #ef4444, #dc2626); }
    </style>
</head>
<body class="min-h-screen p-6">
    <div class="max-w-7xl mx-auto space-y-6 animate-fade-in">

        <!-- Header -->
        <div class="card p-8 text-white">
            <h1 class="text-4xl font-bold mb-2">Charlotte Metro Market Intelligence</h1>
            <p class="text-xl text-gray-300">September 2025 Comprehensive Report</p>
            <div class="mt-4 flex flex-wrap gap-4 text-sm">
                <span class="px-3 py-1 bg-blue-500/20 rounded-full">82 Cities Analyzed</span>
                <span class="px-3 py-1 bg-green-500/20 rounded-full">2,475 Sales</span>
                <span class="px-3 py-1 bg-purple-500/20 rounded-full">9,599 Active Listings</span>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="card p-6 text-white">
            <h2 class="text-2xl font-bold mb-4">Market Overview</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="metric-card p-4 rounded-lg">
                    <div class="text-sm text-gray-400">Market Sentiment</div>
                    <div class="text-2xl font-bold text-yellow-400">NEUTRAL</div>
                    <div class="text-xs mt-2 text-gray-300">Transitioning to balanced market</div>
                </div>
                <div class="metric-card p-4 rounded-lg">
                    <div class="text-sm text-gray-400">Key Insight</div>
                    <div class="text-sm mt-2">Sales up 14.9% YoY with inventory normalizing at 3.9 months supply</div>
                </div>
                <div class="metric-card p-4 rounded-lg">
                    <div class="text-sm text-gray-400">Alert Status</div>
                    <div class="text-lg font-bold text-orange-400">79 Cities Flagged</div>
                    <div class="text-xs mt-2 text-gray-300">DOM increases metro-wide</div>
                </div>
            </div>
        </div>

        <!-- Metro-Level Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Median Sale Price</div>
                <div class="text-3xl font-bold">$438K</div>
                <div class="text-sm mt-2 trend-up">↑ +3.7% YoY</div>
            </div>
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Homes Sold</div>
                <div class="text-3xl font-bold">2,475</div>
                <div class="text-sm mt-2 trend-up">↑ +14.9% YoY</div>
            </div>
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Days on Market</div>
                <div class="text-3xl font-bold">69</div>
                <div class="text-sm mt-2 text-gray-300">Median days to sale</div>
            </div>
            <div class="card p-6 text-white">
                <div class="text-sm text-gray-400 mb-2">Months of Supply</div>
                <div class="text-3xl font-bold">3.9</div>
                <div class="text-sm mt-2 text-green-400">Balanced market</div>
            </div>
        </div>

        <!-- Additional Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Median List Price</div>
                <div class="text-xl font-bold">$453K</div>
            </div>
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Price per SF</div>
                <div class="text-xl font-bold">$221</div>
            </div>
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">Sale-to-List</div>
                <div class="text-xl font-bold">98.2%</div>
            </div>
            <div class="card p-4 text-white">
                <div class="text-xs text-gray-400">New Listings</div>
                <div class="text-xl font-bold">3,053</div>
            </div>
        </div>

        <!-- Search and Filters -->
        <div class="card p-6 text-white">
            <div class="flex flex-col md:flex-row gap-4 items-center justify-between mb-6">
                <h2 class="text-2xl font-bold">Top 10 Cities by Sales Volume</h2>
                <div class="flex gap-2">
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="Search cities..."
                        class="search-input"
                    />
                    <select id="filterSelect" class="search-input">
                        <option value="all">All Markets</option>
                        <option value="hot">Hot (Health ≥70)</option>
                        <option value="cooling">Cooling (Health <60)</option>
                    </select>
                </div>
            </div>

            <!-- Cities Table -->
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="border-b border-gray-600">
                        <tr class="text-left">
                            <th class="pb-3">City</th>
                            <th class="pb-3">Sales</th>
                            <th class="pb-3">Median Price</th>
                            <th class="pb-3">Price YoY</th>
                            <th class="pb-3">DOM</th>
                            <th class="pb-3">Health Score</th>
                        </tr>
                    </thead>
                    <tbody id="citiesTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Selected City Details -->
            <div id="cityDetails" class="mt-6 p-4 bg-white/5 rounded-lg hidden">
                <h3 class="text-lg font-bold mb-2" id="selectedCityName"></h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div>
                        <div class="text-gray-400">Sales Volume</div>
                        <div class="text-xl font-bold" id="detailSales"></div>
                    </div>
                    <div>
                        <div class="text-gray-400">Median Price</div>
                        <div class="text-xl font-bold" id="detailPrice"></div>
                    </div>
                    <div>
                        <div class="text-gray-400">Days on Market</div>
                        <div class="text-xl font-bold" id="detailDOM"></div>
                    </div>
                    <div>
                        <div class="text-gray-400">Market Status</div>
                        <div class="text-xl font-bold" id="detailStatus"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card p-6 text-white">
                <h2 class="text-2xl font-bold mb-4">Sales Volume by City</h2>
                <div class="chart-container">
                    <canvas id="salesChart"></canvas>
                </div>
            </div>

            <div class="card p-6 text-white">
                <h2 class="text-2xl font-bold mb-4">Median Price by City</h2>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card p-6 text-white">
            <h2 class="text-2xl font-bold mb-4">Market Health Score Distribution</h2>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                <div class="text-center">
                    <div class="text-3xl font-bold text-green-400" id="countStrong">0</div>
                    <div class="text-sm text-gray-400">Strong (70+)</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-yellow-400" id="countModerate">0</div>
                    <div class="text-sm text-gray-400">Moderate (60-69)</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-red-400" id="countWeak">0</div>
                    <div class="text-sm text-gray-400">Weak (<60)</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-blue-400" id="avgScore">0</div>
                    <div class="text-sm text-gray-400">Average Score</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold text-purple-400" id="maxScore">0</div>
                    <div class="text-sm text-gray-400">Highest Score</div>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="healthChart"></canvas>
            </div>
        </div>

        <!-- Market Insights -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card p-6 text-white">
                <h3 class="text-xl font-bold mb-4">Hot Markets (Health ≥70)</h3>
                <div id="hotMarkets" class="space-y-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>

            <div class="card p-6 text-white">
                <h3 class="text-xl font-bold mb-4">Cooling Markets (Health <60)</h3>
                <div id="coolingMarkets" class="space-y-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Key Takeaways -->
        <div class="card p-6 text-white">
            <h2 class="text-2xl font-bold mb-4">Key Takeaways</h2>
            <div class="space-y-4">
                <div class="p-4 bg-green-500/10 border-l-4 border-green-500 rounded">
                    <div class="font-bold mb-2">Sales Growth Strong</div>
                    <div class="text-sm text-gray-300">Metro-wide sales increased 14.9% YoY to 2,475 transactions, indicating sustained demand.</div>
                </div>
                <div class="p-4 bg-blue-500/10 border-l-4 border-blue-500 rounded">
                    <div class="font-bold mb-2">Market Normalizing</div>
                    <div class="text-sm text-gray-300">Days on market increased across all cities as market transitions to balanced conditions.</div>
                </div>
                <div class="p-4 bg-yellow-500/10 border-l-4 border-yellow-500 rounded">
                    <div class="font-bold mb-2">Inventory Increasing</div>
                    <div class="text-sm text-gray-300">Active inventory up 16.3% YoY to 9,599 homes, providing more choices for buyers.</div>
                </div>
                <div class="p-4 bg-purple-500/10 border-l-4 border-purple-500 rounded">
                    <div class="font-bold mb-2">Growth Corridors</div>
                    <div class="text-sm text-gray-300">Huntersville, Indian Trail, and Monroe show explosive growth with strong health scores.</div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="card p-6 text-white text-center text-sm text-gray-400">
            <p>Dashboard generated on October 15, 2025 | Data period: September 2025</p>
            <p class="mt-2">Data source: Redfin Market Tracker | Analysis: 82 cities, 2,475 transactions</p>
            <p class="mt-2">Health scores calculated using sales velocity, days on market, pricing trends, and inventory balance</p>
        </div>
    </div>

    <script>
        // Market data
        const top10Cities = [
            { name: 'Charlotte', sales: 958, price: 415000, priceYoY: 0.025, dom: 60, health: 68 },
            { name: 'Huntersville', sales: 107, price: 635000, priceYoY: 0.200, dom: 55, health: 76 },
            { name: 'Gastonia', sales: 102, price: 278750, priceYoY: -0.065, dom: 82, health: 58 },
            { name: 'Concord', sales: 93, price: 398980, priceYoY: -0.020, dom: 68, health: 57 },
            { name: 'Indian Trail', sales: 73, price: 464000, priceYoY: 0.140, dom: 52, health: 69 },
            { name: 'Mooresville', sales: 72, price: 425000, priceYoY: 0.024, dom: 74, health: 68 },
            { name: 'Rock Hill', sales: 72, price: 322000, priceYoY: 0.006, dom: 78, health: 63 },
            { name: 'Kannapolis', sales: 68, price: 297000, priceYoY: -0.002, dom: 61, health: 65 },
            { name: 'Monroe', sales: 64, price: 410350, priceYoY: 0.102, dom: 63, health: 76 },
            { name: 'Cornelius', sales: 61, price: 605000, priceYoY: 0.100, dom: 67, health: 75 }
        ];

        let currentFilter = 'all';
        let searchTerm = '';
        let selectedCity = null;

        // Utility functions
        const formatPrice = (value) => `$${(value / 1000).toFixed(0)}K`;
        const formatPercent = (value) => `${(value * 100).toFixed(1)}%`;
        const getTrendClass = (value) => value > 0 ? 'trend-up' : value < 0 ? 'trend-down' : 'trend-neutral';
        const getTrendIcon = (value) => value > 0 ? '↑' : value < 0 ? '↓' : '→';
        const getHealthClass = (score) => score >= 70 ? 'health-strong' : score >= 60 ? 'health-moderate' : 'health-weak';
        const getHealthText = (score) => score >= 70 ? 'Strong' : score >= 60 ? 'Moderate' : 'Weak';

        // Filter cities
        function getFilteredCities() {
            return top10Cities.filter(city => {
                const matchesSearch = city.name.toLowerCase().includes(searchTerm.toLowerCase());
                if (currentFilter === 'hot') return matchesSearch && city.health >= 70;
                if (currentFilter === 'cooling') return matchesSearch && city.health < 60;
                return matchesSearch;
            });
        }

        // Render cities table
        function renderCitiesTable() {
            const tbody = document.getElementById('citiesTableBody');
            const filtered = getFilteredCities();

            tbody.innerHTML = filtered.map(city => `
                <tr class="city-row border-b border-gray-700" onclick="selectCity('${city.name}')">
                    <td class="py-3 font-medium">${city.name}</td>
                    <td class="py-3">${city.sales}</td>
                    <td class="py-3">${formatPrice(city.price)}</td>
                    <td class="py-3 ${getTrendClass(city.priceYoY)}">
                        ${getTrendIcon(city.priceYoY)} ${formatPercent(city.priceYoY)}
                    </td>
                    <td class="py-3">${city.dom} days</td>
                    <td class="py-3">
                        <span class="health-bar ${getHealthClass(city.health)}"></span>
                        <span class="ml-2">${city.health}</span>
                    </td>
                </tr>
            `).join('');
        }

        // Select city
        function selectCity(cityName) {
            const city = top10Cities.find(c => c.name === cityName);
            if (!city) return;

            if (selectedCity === cityName) {
                selectedCity = null;
                document.getElementById('cityDetails').classList.add('hidden');
            } else {
                selectedCity = cityName;
                document.getElementById('selectedCityName').textContent = city.name + ' Details';
                document.getElementById('detailSales').textContent = city.sales;
                document.getElementById('detailPrice').textContent = formatPrice(city.price);
                document.getElementById('detailDOM').textContent = city.dom + ' days';
                document.getElementById('detailStatus').textContent = getHealthText(city.health);
                document.getElementById('cityDetails').classList.remove('hidden');
            }
        }

        // Render market lists
        function renderMarketLists() {
            const hotMarkets = top10Cities.filter(c => c.health >= 70);
            const coolingMarkets = top10Cities.filter(c => c.health < 60);

            document.getElementById('hotMarkets').innerHTML = hotMarkets.map(city => `
                <div class="flex justify-between items-center p-3 bg-white/5 rounded">
                    <span class="font-medium">${city.name}</span>
                    <div class="flex items-center gap-2">
                        <span class="text-green-400">${formatPercent(city.priceYoY)} YoY</span>
                        <span class="text-sm text-gray-400">${city.health}/100</span>
                    </div>
                </div>
            `).join('');

            document.getElementById('coolingMarkets').innerHTML = coolingMarkets.map(city => `
                <div class="flex justify-between items-center p-3 bg-white/5 rounded">
                    <span class="font-medium">${city.name}</span>
                    <div class="flex items-center gap-2">
                        <span class="${getTrendClass(city.priceYoY)}">${formatPercent(city.priceYoY)} YoY</span>
                        <span class="text-sm text-gray-400">${city.health}/100</span>
                    </div>
                </div>
            `).join('') || '<div class="text-gray-400">No cooling markets in top 10</div>';
        }

        // Update health stats
        function updateHealthStats() {
            const strong = top10Cities.filter(c => c.health >= 70).length;
            const moderate = top10Cities.filter(c => c.health >= 60 && c.health < 70).length;
            const weak = top10Cities.filter(c => c.health < 60).length;
            const avg = Math.round(top10Cities.reduce((sum, c) => sum + c.health, 0) / top10Cities.length);
            const max = Math.max(...top10Cities.map(c => c.health));

            document.getElementById('countStrong').textContent = strong;
            document.getElementById('countModerate').textContent = moderate;
            document.getElementById('countWeak').textContent = weak;
            document.getElementById('avgScore').textContent = avg;
            document.getElementById('maxScore').textContent = max;
        }

        // Chart setup
        Chart.defaults.color = '#9ca3af';
        Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.1)';

        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: 'rgba(15, 52, 96, 0.95)',
                    titleColor: '#fff',
                    bodyColor: '#e5e7eb',
                    borderColor: 'rgba(255, 255, 255, 0.2)',
                    borderWidth: 1
                }
            },
            scales: {
                y: {
                    grid: { color: 'rgba(255, 255, 255, 0.05)' },
                    ticks: { color: '#9ca3af' }
                },
                x: {
                    grid: { display: false },
                    ticks: { color: '#9ca3af', maxRotation: 45, minRotation: 45 }
                }
            }
        };

        // Sales Chart
        new Chart(document.getElementById('salesChart'), {
            type: 'bar',
            data: {
                labels: top10Cities.map(c => c.name),
                datasets: [{
                    label: 'Sales',
                    data: top10Cities.map(c => c.sales),
                    backgroundColor: '#3b82f6'
                }]
            },
            options: chartOptions
        });

        // Price Chart
        new Chart(document.getElementById('priceChart'), {
            type: 'bar',
            data: {
                labels: top10Cities.map(c => c.name),
                datasets: [{
                    label: 'Median Price',
                    data: top10Cities.map(c => c.price),
                    backgroundColor: '#10b981'
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            color: '#9ca3af',
                            callback: (value) => formatPrice(value)
                        }
                    }
                }
            }
        });

        // Health Chart
        new Chart(document.getElementById('healthChart'), {
            type: 'bar',
            data: {
                labels: top10Cities.map(c => c.name),
                datasets: [{
                    label: 'Health Score',
                    data: top10Cities.map(c => c.health),
                    backgroundColor: top10Cities.map(c =>
                        c.health >= 70 ? '#10b981' : c.health >= 60 ? '#f59e0b' : '#ef4444'
                    )
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        min: 0,
                        max: 100
                    }
                }
            }
        });

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchTerm = e.target.value;
            renderCitiesTable();
        });

        document.getElementById('filterSelect').addEventListener('change', (e) => {
            currentFilter = e.target.value;
            renderCitiesTable();
        });

        // Initial render
        renderCitiesTable();
        renderMarketLists();
        updateHealthStats();
    </script>
</body>
</html>
